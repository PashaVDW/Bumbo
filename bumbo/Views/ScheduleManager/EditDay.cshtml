@model ScheduleManagerEditViewModel

@{
    ViewData["Title"] = "EditDay";
}


<div class="max-w-2xl mx-auto mt-10 p-6 rounded relative">
    <custom-modal modal-id="removeEmployeeFromDay" body-text="Weet je zeker dat je de medewerker van deze dag wil halen?">
        <default-button id="removeEmployee" button-text="Delete" button-type="delete" onclick=""></default-button>
        <default-button button-text="Cancel" button-type="secondary" on-click="document.getElementById('removeEmployeeFromDay').classList.add('hidden')"></default-button>
    </custom-modal>

    <div class="flex justify-between">
        <div class="mb-6 flex">
            <a href="/roosterManager" style="margin-right: 25px">
                <svg width="19" height="38" viewBox="0 0 19 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.2502 35.5L3.66687 21.9167C2.0627 20.3125 2.0627 17.6875 3.66687 16.0833L17.2502 2.5" stroke="black" stroke-width="3.125" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            </a>
            <h1 class="text-3xl font-semibold">@Html.Raw(ViewBag.Day)</h1>
        </div>
        <div>
            <default-button button-text="Opslaan" button-type="primary" on-click="document.getElementById('editDayForm').submit();"></default-button>
        </div>
    </div>

    <form asp-action="EditDay" method="post" id="editDayForm">
        @foreach (var department in Model.Departments)
        {
            <div class="mb-8">
                <h2 class="text-2xl font-semibold">@department.DepartmentName</h2>
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <span class="mr-4 font-bold">Benodigde uren: @department.HoursNeeded</span>
                        <span class="font-bold">Ingeplande uren: @department.TotalHours</span>
                    </div>
                </div>

                @foreach (var employee in department.Employees)
                {
                    <div class="grid grid-cols-10 items-center gap-4 mb-2 p-5 rounded border border-gray-400">
                        <span class="mr-4 col-span-2">@employee.EmployeeName</span>

                        <select name="selectedDepartment" class="bg-gray-200 border-gray-400 py-2 px-3 text-gray-700 rounded border leading-tight col-span-3"
                                asp-for="@employee.DepartmentName"
                                asp-items="@(new SelectList(Model.Departments, "DepartmentName", "DepartmentName", employee.DepartmentName))">
                        </select>

                        <input type="time" value="@employee.StartTime.ToString("HH\\:mm")" class="bg-gray-200 border-gray-400 py-2 px-3 text-gray-700 appearance-none rounded border leading-tight col-span-2" />
                        <input type="time" value="@employee.EndTime.ToString("HH\\:mm")" class="bg-gray-200 border-gray-400 py-2 px-3 text-gray-700 appearance-none rounded border leading-tight col-span-2" />

                        <a class="text-red-500 justify-self-end" title="Delete" href="javascript:void(0);" onclick="
                            document.getElementById('removeEmployeeFromDay').classList.remove('hidden');
                            document.getElementById('removeEmployee').onclick = function() {
                                window.location.href = '@Url.Action("RemoveEmployeeFromDay", "ScheduleManager", new { specificDate = Model.Date, EmployeeId = employee.EmployeeId})';
                            };
                        ">
                            <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </a>
                    </div>
                }

                <a class="flex justify-center items-center border border-dashed border-gray-400 rounded p-4 w-full mt-4" href="@Url.Action("ChooseEmployee", "ScheduleManager", new { dateString =  Model.Date, department = department.DepartmentName })">
                    <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m6-6H6" />
                    </svg>
                    <span class="ml-2">Medewerker toevoegen</span>
                </a>
            </div>
        }
    </form>
</div>
@{
    if (TempData["ToastMessage"] != null && TempData["ToastType"] != null)
    {
        <toast-message toast-id="@TempData["ToastId"]"
                       message="@TempData["ToastMessage"]"
                       message-type="@TempData["ToastType"]">
        </toast-message>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                showToast('@TempData["ToastId"]', '@TempData["AutoHide"]', @TempData["MilSecHide"]);
            });
        </script>
    }
}